export const defaultModelMapper: Record<string, string> = {
  // GPT-5.2 series
  "gpt-5.2": "gpt-5.2",
  "gpt-5.2-2025-12-11": "gpt-5.2-2025-12-11",
  "gpt-5.2-chat": "gpt-5.2-chat",
  "gpt-5.2-chat-2025-12-11": "gpt-5.2-chat-2025-12-11",
  // GPT-5.1 series
  "gpt-5.1": "gpt-5.1",
  "gpt-5.1-2025-11-13": "gpt-5.1-2025-11-13",
  "gpt-5.1-chat": "gpt-5.1-chat",
  "gpt-5.1-chat-2025-11-13": "gpt-5.1-chat-2025-11-13",
  "gpt-5.1-codex": "gpt-5.1-codex",
  "gpt-5.1-codex-2025-11-13": "gpt-5.1-codex-2025-11-13",
  "gpt-5.1-codex-mini": "gpt-5.1-codex-mini",
  "gpt-5.1-codex-mini-2025-11-13": "gpt-5.1-codex-mini-2025-11-13",
  "gpt-5.1-codex-max": "gpt-5.1-codex-max",
  "gpt-5.1-codex-max-2025-12-04": "gpt-5.1-codex-max-2025-12-04",
  // GPT-5 series
  "gpt-5": "gpt-5",
  "gpt-5-2025-08-07": "gpt-5-2025-08-07",
  "gpt-5-mini": "gpt-5-mini",
  "gpt-5-mini-2025-08-07": "gpt-5-mini-2025-08-07",
  "gpt-5-nano": "gpt-5-nano",
  "gpt-5-nano-2025-08-07": "gpt-5-nano-2025-08-07",
  "gpt-5-chat": "gpt-5-chat",
  "gpt-5-chat-2025-08-07": "gpt-5-chat-2025-08-07",
  "gpt-5-chat-2025-10-03": "gpt-5-chat-2025-10-03",
  "gpt-5-codex": "gpt-5-codex",
  "gpt-5-codex-2025-09-11": "gpt-5-codex-2025-09-11",
  "gpt-5-pro": "gpt-5-pro",
  "gpt-5-pro-2025-10-06": "gpt-5-pro-2025-10-06",
  // GPT-4.1 series
  "gpt-4.1": "gpt-4.1",
  "gpt-4.1-2025-04-14": "gpt-4.1-2025-04-14",
  "gpt-4.1-mini": "gpt-4.1-mini",
  "gpt-4.1-mini-2025-04-14": "gpt-4.1-mini-2025-04-14",
  "gpt-4.1-nano": "gpt-4.1-nano",
  "gpt-4.1-nano-2025-04-14": "gpt-4.1-nano-2025-04-14",
  // O-series reasoning models
  "o1": "o1",
  "o1-2024-12-17": "o1-2024-12-17",
  "o1-preview": "o1-preview",
  "o1-preview-2024-09-12": "o1-preview-2024-09-12",
  "o1-mini": "o1-mini",
  "o1-mini-2024-09-12": "o1-mini-2024-09-12",
  "o3": "o3",
  "o3-2025-04-16": "o3-2025-04-16",
  "o3-mini": "o3-mini",
  "o3-mini-2025-01-31": "o3-mini-2025-01-31",
  "o3-pro": "o3-pro",
  "o3-pro-2025-06-10": "o3-pro-2025-06-10",
  "o3-deep-research": "o3-deep-research",
  "o3-deep-research-2025-06-26": "o3-deep-research-2025-06-26",
  "o4": "o4",
  "o4-mini": "o4-mini",
  "o4-mini-2025-04-16": "o4-mini-2025-04-16",
  "codex-mini": "codex-mini",
  "codex-mini-2025-05-16": "codex-mini-2025-05-16",
  "computer-use-preview": "computer-use-preview",
  "computer-use-preview-2025-03-11": "computer-use-preview-2025-03-11",
  // gpt-oss
  "gpt-oss-120b": "gpt-oss-120b",
  "gpt-oss-20b": "gpt-oss-20b",
  // Claude models (Azure Foundry)
  "claude-opus-4.5": "claude-opus-4.5",
  "claude-opus-4-5": "claude-opus-4.5",
  "claude-sonnet-4.5": "claude-sonnet-4.5",
  "claude-sonnet-4-5": "claude-sonnet-4.5",
  "claude-haiku-4.5": "claude-haiku-4.5",
  "claude-haiku-4-5": "claude-haiku-4.5",
  "claude-opus-4.1": "claude-opus-4.1",
  "claude-opus-4-1": "claude-opus-4.1",
  // GPT-4o models
  "gpt-4o": "gpt-4o",
  "gpt-4o-2024-05-13": "gpt-4o-2024-05-13",
  "gpt-4o-2024-08-06": "gpt-4o-2024-08-06",
  "gpt-4o-2024-11-20": "gpt-4o-2024-11-20",
  "gpt-4o-mini": "gpt-4o-mini",
  "gpt-4o-mini-2024-07-18": "gpt-4o-mini-2024-07-18",
  // GPT-4 models
  "gpt-4": "gpt-4-0613",
  "gpt-4-0613": "gpt-4-0613",
  "gpt-4-1106-preview": "gpt-4-1106-preview",
  "gpt-4-0125-preview": "gpt-4-0125-preview",
  "gpt-4-vision-preview": "gpt-4-vision-preview",
  "gpt-4-turbo": "gpt-4-turbo",
  "gpt-4-turbo-2024-04-09": "gpt-4-turbo-2024-04-09",
  "gpt-4-32k": "gpt-4-32k-0613",
  "gpt-4-32k-0613": "gpt-4-32k-0613",
  // GPT-3.5 models
  "gpt-3.5-turbo": "gpt-35-turbo-0613",
  "gpt-3.5-turbo-0301": "gpt-35-turbo-0301",
  "gpt-3.5-turbo-0613": "gpt-35-turbo-0613",
  "gpt-3.5-turbo-1106": "gpt-35-turbo-1106",
  "gpt-3.5-turbo-0125": "gpt-35-turbo-0125",
  "gpt-3.5-turbo-16k": "gpt-35-turbo-16k-0613",
  "gpt-3.5-turbo-16k-0613": "gpt-35-turbo-16k-0613",
  "gpt-3.5-turbo-instruct": "gpt-35-turbo-instruct-0914",
  "gpt-3.5-turbo-instruct-0914": "gpt-35-turbo-instruct-0914",
  // Embedding models
  "text-embedding-3-small": "text-embedding-3-small-1",
  "text-embedding-3-large": "text-embedding-3-large-1",
  "text-embedding-ada-002": "text-embedding-ada-002-2",
  "text-embedding-ada-002-1": "text-embedding-ada-002-1",
  "text-embedding-ada-002-2": "text-embedding-ada-002-2",
  // DALL-E models
  "dall-e-2": "dall-e-2-2.0",
  "dall-e-2-2.0": "dall-e-2-2.0",
  "dall-e-3": "dall-e-3-3.0",
  "dall-e-3-3.0": "dall-e-3-3.0",
  // Legacy models
  "babbage-002": "babbage-002-1",
  "babbage-002-1": "babbage-002-1",
  "davinci-002": "davinci-002-1",
  "davinci-002-1": "davinci-002-1",
  // Audio models
  "gpt-4o-audio-preview": "gpt-4o-audio-preview",
  "gpt-4o-audio-preview-2024-12-17": "gpt-4o-audio-preview-2024-12-17",
  "gpt-4o-mini-audio-preview": "gpt-4o-mini-audio-preview",
  "gpt-4o-mini-audio-preview-2024-12-17":
    "gpt-4o-mini-audio-preview-2024-12-17",
  "gpt-4o-realtime-preview": "gpt-4o-realtime-preview",
  "gpt-4o-realtime-preview-2024-12-17":
    "gpt-4o-realtime-preview-2024-12-17",
  "gpt-4o-realtime-preview-2025-06-03":
    "gpt-4o-realtime-preview-2025-06-03",
  "gpt-4o-mini-realtime-preview": "gpt-4o-mini-realtime-preview",
  "gpt-4o-mini-realtime-preview-2024-12-17":
    "gpt-4o-mini-realtime-preview-2024-12-17",
  "gpt-realtime": "gpt-realtime",
  "gpt-realtime-2025-08-28": "gpt-realtime-2025-08-28",
  "gpt-realtime-mini": "gpt-realtime-mini",
  "gpt-realtime-mini-2025-10-06": "gpt-realtime-mini-2025-10-06",
  "gpt-audio": "gpt-audio",
  "gpt-audio-2025-08-28": "gpt-audio-2025-08-28",
  "gpt-audio-mini": "gpt-audio-mini",
  "gpt-audio-mini-2025-10-06": "gpt-audio-mini-2025-10-06",
  // Speech-to-text models
  "gpt-4o-transcribe": "gpt-4o-transcribe",
  "gpt-4o-transcribe-2025-03-20": "gpt-4o-transcribe-2025-03-20",
  "gpt-4o-mini-transcribe": "gpt-4o-mini-transcribe",
  "gpt-4o-mini-transcribe-2025-03-20":
    "gpt-4o-mini-transcribe-2025-03-20",
  "gpt-4o-transcribe-diarize": "gpt-4o-transcribe-diarize",
  "gpt-4o-transcribe-diarize-2025-10-15":
    "gpt-4o-transcribe-diarize-2025-10-15",
  // TTS models
  "tts": "tts-001",
  "tts-001": "tts-001",
  "tts-hd": "tts-hd-001",
  "tts-hd-001": "tts-hd-001",
  "gpt-4o-mini-tts": "gpt-4o-mini-tts",
  "gpt-4o-mini-tts-2025-03-20": "gpt-4o-mini-tts-2025-03-20",
  // Whisper models
  "whisper": "whisper-001",
  "whisper-001": "whisper-001",
  // Image generation models
  "gpt-image-1": "gpt-image-1",
  "gpt-image-1-2025-04-15": "gpt-image-1-2025-04-15",
  "gpt-image-1-mini": "gpt-image-1-mini",
  "gpt-image-1-mini-2025-10-06": "gpt-image-1-mini-2025-10-06",
  // Video generation models
  "sora": "sora",
  "sora-2025-05-02": "sora-2025-05-02",
  "sora-2": "sora-2",
  "sora-2-2025-10-06": "sora-2-2025-10-06",
  // Phi models (Azure Foundry)
  "phi-3": "phi-3",
  "phi-3-mini": "phi-3-mini",
  "phi-3-small": "phi-3-small",
  "phi-3-medium": "phi-3-medium",
  "phi-4": "phi-4",
};

const versionSuffixRe = /-\d{4}-\d{2}-\d{2}$|-\d{8}$/;

function stripModelVersion(model: string): string {
  return model.replace(versionSuffixRe, "");
}

export function resolveModelDeployment(
  model: string,
  mapper: Record<string, string>,
): string {
  const lower = model.toLowerCase();

  // Exact match
  if (mapper[lower]) return mapper[lower];

  // Strip version suffix and retry
  const stripped = stripModelVersion(lower);
  if (stripped !== lower && mapper[stripped]) return mapper[stripped];

  // Fall back to original name (custom deployments)
  return model;
}
